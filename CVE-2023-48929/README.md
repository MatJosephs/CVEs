# Proof of Concept for CVE-2023-48929

## Description
**Franklin Fueling Systems System Sentinel AnyWare (SSA) 1.6.24.492** manages user sessions improperly due to the Session ID (SID) being placed within the URL.
The SID is included within the URL as follows: **<VULNERABLE_SITE>/ssa/group_status.asp?sid=<SID>**.

The SID can be then used in any browser to bypass authentication and hijack the session.

The SID lacks sufficient randomness and is susceptible to brute force attacks.
![image](https://github.com/MatJosephs/CVEs/assets/73303726/fb73a720-1389-4fe2-bb4d-2aaf394da299)

## Attack Scenario
### Option 1
1) An attacker obtains the URL from a victim
2) The attacker can take over the session by simply accessing the URL
### Option 2
1) An attacker attempts to bruteforce the SID
2) If a valid SID is obtained, the attacker can bypass authentication

## Suggested CVSS 3.1 Vector
5.6 AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:L

## Token Analysis
Based on the analysis of 10k SIDs, the following table was generated. The first column indicates the position of the character, and each value represents the frequency of the character within the indicated position.
For instance, **B** appeared on position **0** **430** times, **C** appeared on position **2** **414** times. Considering that the average frequency is 448.86, 
one could analyse which characters are more likely to appear in certain positions.
|    | a  | b   | c   | d   | e   | f   | g   | h   | i   | j   | k   | l   | m   | n   | o   | p   | q   | r   | s   | t   | u   | v   | w   | x   | y   | z   | 0   | 1   | 2   | 3   | 4   | 5   | 6   | 7   | 8   | 9   |    
|----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|
| 0  | 396 | 430 | 421 | 442 | 493 | 422 | 459 | 419 | 418 | 482 | 466 | 487 | 446 | 408 | 440 | 444 | 466 | 494 | 412 | 415 | 432 | 440 | 516 | 456 | 452 | 433 | 431 | 472 | 436 | 490 | 492 | 406 | 439 | 442 | 443 | 519 |
| 1  | 438 | 460 | 483 | 442 | 465 | 466 | 438 | 442 | 453 | 424 | 471 | 441 | 473 | 431 | 455 | 459 | 445 | 446 | 441 | 451 | 434 | 421 | 427 | 442 | 391 | 456 | 475 | 457 | 462 | 456 | 450 | 464 | 459 | 443 | 441 | 457 |
| 2  | 440 | 438 | 414 | 428 | 450 | 449 | 448 | 446 | 462 | 461 | 428 | 477 | 458 | 434 | 431 | 477 | 445 | 447 | 445 | 476 | 445 | 464 | 458 | 461 | 428 | 449 | 449 | 475 | 427 | 446 | 436 | 442 | 452 | 496 | 424 | 453 |
| 3  | 466 | 438 | 451 | 445 | 425 | 486 | 411 | 453 | 431 | 447 | 460 | 445 | 455 | 455 | 454 | 457 | 433 | 462 | 441 | 464 | 456 | 445 | 438 | 445 | 422 | 436 | 459 | 458 | 438 | 520 | 453 | 483 | 421 | 432 | 453 | 421 |
| 4  | 439 | 432 | 475 | 436 | 451 | 481 | 422 | 448 | 474 | 425 | 473 | 475 | 440 | 445 | 445 | 444 | 436 | 481 | 465 | 449 | 466 | 427 | 438 | 441 | 468 | 435 | 441 | 442 | 435 | 445 | 434 | 436 | 465 | 442 | 443 | 465 |
| 5  | 463 | 462 | 434 | 452 | 445 | 419 | 461 | 429 | 470 | 449 | 485 | 436 | 490 | 436 | 438 | 444 | 434 | 452 | 450 | 478 | 415 | 485 | 444 | 467 | 443 | 447 | 462 | 437 | 460 | 423 | 450 | 432 | 423 | 437 | 445 | 462 |
| 6  | 457 | 499 | 478 | 428 | 459 | 471 | 460 | 408 | 456 | 492 | 420 | 422 | 422 | 478 | 475 | 426 | 424 | 431 | 457 | 473 | 449 | 397 | 420 | 487 | 456 | 445 | 484 | 446 | 486 | 404 | 440 | 460 | 440 | 455 | 402 | 452 |
| 7  | 457 | 441 | 437 | 466 | 429 | 429 | 471 | 433 | 457 | 462 | 446 | 461 | 467 | 438 | 448 | 435 | 443 | 432 | 462 | 397 | 478 | 461 | 448 | 441 | 443 | 442 | 447 | 465 | 456 | 465 | 473 | 447 | 453 | 422 | 450 | 457 |
| 8  | 421 | 445 | 426 | 431 | 486 | 455 | 477 | 427 | 457 | 462 | 481 | 447 | 407 | 446 | 454 | 459 | 451 | 454 | 461 | 448 | 487 | 442 | 451 | 444 | 411 | 448 | 444 | 416 | 449 | 447 | 430 | 475 | 477 | 425 | 438 | 480 |
| 9  | 462 | 455 | 455 | 444 | 444 | 449 | 440 | 476 | 442 | 446 | 478 | 419 | 414 | 430 | 459 | 471 | 406 | 447 | 428 | 445 | 471 | 461 | 460 | 453 | 462 | 474 | 419 | 491 | 477 | 439 | 429 | 416 | 450 | 468 | 418 | 461 |
| 10 | 422 | 423 | 448 | 456 | 409 | 441 | 450 | 466 | 498 | 460 | 442 | 447 | 429 | 484 | 444 | 440 | 460 | 451 | 458 | 446 | 434 | 426 | 454 | 454 | 458 | 440 | 431 | 453 | 461 | 469 | 443 | 442 | 442 | 475 | 453 | 450 |
| 11 | 433 | 496 | 411 | 444 | 473 | 423 | 440 | 457 | 448 | 404 | 464 | 460 | 413 | 442 | 443 | 426 | 420 | 521 | 448 | 429 | 454 | 441 | 406 | 483 | 489 | 418 | 444 | 465 | 445 | 469 | 504 | 468 | 434 | 422 | 451 | 471 |

